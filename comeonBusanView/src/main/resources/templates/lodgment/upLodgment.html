<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<title>숙박 수정</title>
<script src="/js/common.js"></script>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

	<style>
		#container {
			width: 50%;
			max-width: 1200px;
			margin: 0 auto;
			padding: 20px;
			box-sizing: border-box;
			background-color: #fff;
			border-radius: 8px;
			box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
		}
		
		input[type="text"] {
	        width: 100%;
	        padding: 10px;
	        margin: 10px 0;
	        border: 1px solid #a8d0e6; /* 연한 파란색 테두리 */
	        border-radius: 10px; /* 둥근 모서리 */
	        box-sizing: border-box;
	    }
	    
	    form {
	        display: flex;
	        flex-direction: column;
	        align-items: center;
	    }
	    
	    .radio-group {
            display: flex;
            gap: 10px; /* 라디오 버튼 사이의 간격 조절 */
        }

        .radio-group input[type="radio"] {
            display: none; /* 기본 라디오 버튼 숨기기 */
        }

        .radio-group label {
            position: relative;
            padding-left: 30px;
            cursor: pointer;
            display: inline-block;
            line-height: 20px;
        }

        .radio-group label:before {
            content: '';
            position: absolute;
            left: 0;
            top: 50%;
            transform: translateY(-50%);
            width: 20px;
            height: 20px;
            border: 2px solid #007bff;
            background-color: #fff;
            box-sizing: border-box;
            border-radius: 4px; /* 네모난 체크박스 */
        }

        .radio-group input[type="radio"]:checked + label:before {
            background-color: #007bff; /* 선택 시 파란색 배경 */
            border: none; /* 선택 시 테두리 제거 */
        }

        .radio-group input[type="radio"]:checked + label:after {
            content: '';
            position: absolute;
            left: 5px;
            top: 50%;
            transform: translateY(-50%) rotate(45deg);
            width: 5px;
            height: 10px;
            border: solid white;
            border-width: 0 2px 2px 0;
            box-sizing: border-box;
        }
        
        input[type="submit"] {
	    	background-color: #a8d0e6;
	    	width: 50%;
	    	height: 100px; 
	    	border-radius: 10px;
	    	font-weight: bold;
	    	font-size: 25px;
	    }
	    
	    input[type="submit"]:hover {
	    	background-color: #91b4cc;
	    }
	</style>
</head>
<body>
    <header>
		<th:block th:insert="~{/fragments/header2.html}"></th:block>
	</header>
	
	<div id="container">
		<form id="frm">
	        <input type="text" name="업체명" placeholder="업체명"><br>
	        <div class="radio-group">
		        <input type="radio" name="카테고리명" value="숙박/휴양" id="숙박/휴양">
		        <label for="숙박/휴양">숙박/휴양</label>
		        
		        <input type="radio" name="카테고리명" value="문화관광/명소" id="문화관광/명소">
		        <label for="문화관광/명소">문화관광/명소</label>
	        </div>
	        <input type="text" name="시도명" value="부산광역시"><br>
	        <input type="text" name="시군구명" placeholder="시군구명"><br>
	        <input type="text" name="읍면동명" placeholder="읍면동명"><br>
	        <input type="text" name="리명" placeholder="리명"><br>
	        <input type="text" name="번지" placeholder="번지"><br>
	        <input type="text" name="도로명" placeholder="도로명"><br>
	        <input type="text" name="도로명상세" placeholder="도로명 상세"><br>
	        <input type="text" name="위도" placeholder="위도"><br>
	        <input type="text" name="경도" placeholder="경도"><br>
	        <input type="text" name="전화번호" placeholder="전화번호"><br>
	        <input type="text" name="홈페이지주소" placeholder="홈페이지 주소"><br>
	        <input type="submit" value="수정">
	    </form>
	</div>
    
<footer>
	<th:block th:insert="~{/fragments/footer.html}"></th:block>
</footer>
<script>
    $(document).ready(function(){
        function getParameterByName(name){
            const url = new URL(window.location.href);
            return url.searchParams.get(name);
        }

        const lid = getParameterByName('lid');

        if(!lid){
            alert("숙박업체 ID가 제공되지 않았습니다.");
            return;
        }

        $.ajax({
            url: `http://localhost:9002/lodgment/${lid}`,
            type: 'GET',
            success: function(data){
                if(data){
                    $('input[name="업체명"]').val(data.업체명);
                    $('input[name="카테고리명"][value="' + data.카테고리명 + '"]').prop('checked', true);
                    $('input[name="시도명"]').val(data.시도명);
                    $('input[name="시군구명"]').val(data.시군구명);
                    $('input[name="읍면동명"]').val(data.읍면동명);
                    $('input[name="리명"]').val(data.리명);
                    $('input[name="번지"]').val(data.번지);
                    $('input[name="도로명"]').val(data.도로명);
                    $('input[name="도로명상세"]').val(data.도로명상세);
                    $('input[name="위도"]').val(data.위도);
                    $('input[name="경도"]').val(data.경도);
                    $('input[name="전화번호"]').val(data.전화번호);
                    $('input[name="홈페이지주소"]').val(data.홈페이지주소);
                }
            },
            error: function(error) {
                console.error('Error fetching lodgment data:', error);
                alert('숙박업체 데이터를 가져오는 중 오류가 발생했습니다.');
            }
        })

        $('#frm').submit(function(event){
            event.preventDefault();

            const form = document.getElementById('frm');
            const formData = new FormData(form);

            fetch(`http://localhost:9002/lodgment/${lid}`,{
                method: 'PUT',
                body: formData
            })
            .then(response => {
                if(!response.ok){
                    throw new Error('Network response was not ok');
                }
                return response.text();
            })
            .then(data => {
                console.log('Success', data);
                alert('수정성공!');
                window.location.href = `lodgment`;
            })
            .catch((error) => {
                console.error('Error:', error);
                alert('수정실패..');
            });
        });
    });
</script>

</body>
</html>
