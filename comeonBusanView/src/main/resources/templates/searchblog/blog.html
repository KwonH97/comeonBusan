<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<title>Blog Reviews</title>
<link rel="stylesheet" th:href="@{/css/header.css}">
<script src="/js/common.js"></script>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<style>
.blog-review {
    border: 1px solid #ddd;
    padding: 10px;
    margin: 10px 0;
    cursor: pointer; /* Add a pointer cursor to indicate the div is clickable */
}
</style>
</head>
<body>
    <div th:replace="fragments/header :: header"></div>
    <div id="reviewContainer"></div>
</body>

<script>
    $(document).ready(function() {
        const urlParams = new URLSearchParams(window.location.search);
        const lid = urlParams.get('lid');

        if (lid) {
            $.ajax({
                url: `http://localhost:9002/blog?lid=${lid}`,
                type: 'GET',
                success: function(response) {
                    const blogData = JSON.parse(response.result);
                    $('#reviewContainer').empty();
                    if (blogData.items && blogData.items.length > 0) {
                        blogData.items.forEach(function(item) {
                            const blogLink = item.link;
                            const blogTitle = item.title;
                            const blogDescription = item.description;
                            $('#reviewContainer').append(`
                                <div class="blog-review" onclick="window.open('${blogLink}', '_blank')">
                                    <h4>${blogTitle}</h4>
                                    <p>${blogDescription}</p>
                                </div>
                            `);
                        });
                    } else {
                        $('#reviewContainer').append('<p>No reviews found.</p>');
                    }
                },
                error: function(error) {
                    console.error('Error fetching blog data:', error);
                    alert('블로그 데이터를 가져오는 중 오류가 발생했습니다.');
                }
            });
        } else {
            $('#reviewContainer').append('<p>유효한 숙박업소 ID가 제공되지 않았습니다.</p>');
        }
    });
</script>
</html>
