<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
<meta charset="UTF-8">
<title>Insert title here</title>
<script src="https://code.jquery.com/jquery-3.7.1.js"
	integrity="sha256-eKhayi8LEQwp4NKxN+CfCh+3qOVUtJn3QNZ0TciWLP4="
	crossorigin="anonymous"></script>
<style>
body {
	font-family: Arial, sans-serif;
	margin: 0;
	padding: 0;
	background-color: #f4f4f4;
}

h1 {
	text-align: center;
	color: #333;
	margin: 2rem 0;
}

hr {
	margin: 1rem auto;
	width: 80%;
	border: 0;
	border-top: 1px solid #ddd;
}

#container {
	max-width: 800px;
	margin: 2rem auto;
	padding: 1rem;
	background-color: #fff;
	box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
	border-radius: 0.5rem;
}

form {
	display: flex;
	flex-direction: column;
}

ul {
	list-style: none;
	padding: 0;
}

li {
	margin-bottom: 0.5rem;
	font-weight: bold;
	color: #333;
}

.form-group {
	display: flex;
	flex-direction: column;
	margin-bottom: 1rem;
}

.form-group label {
	font-weight: bold;
	color: #333;
	margin-bottom: 0.5rem;
}

.form-group input[type="text"], .form-group textarea, .form-group input[type="file"]
	{
	width: 100%;
	padding: 0.75rem;
	border: 1px solid #ddd;
	border-radius: 0.25rem;
	box-sizing: border-box;
}

.form-group textarea {
	height: 100px;
	resize: vertical;
}

#container .form-group input[type="button"], #container .form-group input[type="submit"]
	{
	align-self: center;
	margin-top: 1rem;
	padding: 0.75rem 1.5rem;
	background-color: #007BFF;
	color: #fff;
	border: none;
	border-radius: 0.25rem;
	cursor: pointer;
	font-size: 1rem;
}

#container .form-group input[type="button"]:hover, #container .form-group input[type="submit"]:hover
	{
	background-color: #0056b3;
}
</style>
</head>
<body>
	<header>
		<th:block th:insert="~{/fragments/header2.html}"></th:block>
	</header>
	<h1>공지사항 수정</h1>

	<div id="container">
		<form name="frm" id="frm">
			<div class="form-group">
				<label for="title">공지제목</label> <input type="text" id="title"
					name="title" required />
			</div>
			<div class="form-group">
				<label for="content">공지내용</label>
				<textarea id="content" name="content" required></textarea>
			</div>
			<div class="form-group">
				<label for="file">첨부파일(이미지)</label> <input type="file" id="file"
					name="file" />
			</div>
			<input type="button" value="수정하기" onclick="submitForm()" />
		</form>
	</div>
	<footer>
		<th:block th:insert="~{/fragments/footer.html}"></th:block>
	</footer>
	<script>
		var hnum = "[[${id}]]";

		$(document).ready(function() {
			console.log("noticeModifyPage....................");
			console.log(hnum);

			$.ajax({

				url : "http://localhost:9002/khj/noticeDetail/" + hnum,
				method : "GET",
				success : function(response) {

					console.log("데이터", response);
					$("input[name='title']").val(response.title);
					$("textarea[name='content']").val(response.content);
					//$("input[name='file']").val(response.himg);
				},
				error : function(error) {

					console.log("Error : ", error);
				}

			});

		});

		function submitForm() {

			var form = document.getElementById('frm');

			if (!form) {

				console.error("Form not found....");
				return;
			}

			var formData = new FormData(form);

			console.log(formData);

			let token = localStorage.getItem("Authorization");

			$.ajax({

				url : "http://localhost:9002/khj/noticeModify/" + hnum,
				method : "PUT",
				enctype : "multipart/form-data",
				headers : {

					"Authorization" : token

				},
				data : formData,
				processData : false,
				contentType : false,
				success : function(response) {

					console.log("success : ", response);
					alert("공지사항이 수정되었습니다.");
					window.location.href = "/notice/noticeDetail?hnum=" + hnum

				},
				error : function(e) {
					console.log("error : ", e);

				}

			});

		}
	</script>

</body>

</html>