<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
<script src="https://code.jquery.com/jquery-3.7.1.js" integrity="sha256-eKhayi8LEQwp4NKxN+CfCh+3qOVUtJn3QNZ0TciWLP4=" crossorigin="anonymous"></script>
<style>
    body {
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 0;
        background-color: #f4f4f4;
    }

    h1 {
        text-align: center;
        color: #333;
        margin: 2rem 0;
    }
    table {
        width: 80%;
        margin: 0 auto;
        margin-bottom: 200px;
        border-collapse: collapse;
        background-color: #fff;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
    }
    th, td {
        padding: 0.75rem;
        border: 1px solid #ddd;
        text-align: center;
    }
    th {
        background-color: #f8f8f8;
    }
    a {
        color: #007BFF;
        text-decoration: none;
    }
    a:hover {
        text-decoration: underline;
    }
    .hiddenButton {
        display: none;
        margin: 2rem auto;
        padding: 0.75rem 1.5rem;
            background-color: white;
            color: black;
            border: solid 1px;
        border-radius: 0.25rem;
        cursor: pointer;
        font-size: 1rem;
    }
    .hiddenButton:hover {
        background-color: #0056b3;
    }
</style>
</head>
<body>
<header>
        <th:block th:insert="~{/fragments/header2.html}"></th:block>
</header>
<h1>공지</h1>
<button class="hiddenButton" style="display: none;" id="addButton" onclick="goAddPage(event)">등록하기</button>
<table border="1">
	<thead>
		<tr>
			<th>글번호</th>
			<th>제목</th>
			<th>작성일</th>
		</tr>
	</thead>
	<tbody id="noticeTableBody">
	
	</tbody>
</table>
  <footer>
    <th:block th:insert="~{/fragments/footer.html}"></th:block>
  </footer>
<script>
	
	$(document).ready(function(){
		
		var authValue = localStorage.getItem("Authorization");
		if(authValue != null){
			$(".hiddenButton").css("display", "block");
			
		}
		
		console.log("noticeList...........");
		
		$.ajax({
			url: 'http://localhost:9002/khj/noticeList',
			method: 'GET',
			success: function(response){
				
				console.log("찾아온 공지사항 데이터 " , response);
				
				// 공지사항 데이터를 테이블에 추가
				
				let noticeTableBody = $('#noticeTableBody');
				
				response.forEach(function(notice){
					// 날짜 형식을 YYYY.MM.DD로 변경
					
					let formattedDate = notice.regDate.replace(/-/g, '.');
					
					let row = `
						<tr>
							<td>${notice.hnum}</td>
							<td><a href="/notice/noticeDetail?hnum=${notice.hnum}">${notice.title}</a></td>
							<td>${formattedDate}</td>
						</tr>
					`;
					
					noticeTableBody.append(row);
				});
				
			},
			error: function(error){
				console.error("공지사항 데이터를 불러오는 데 실패했습니다 : ", error);
			}
		});
		
	});
	
	function goAddPage(){
		
		window.location.href="/notice/noticeAdd";
		
		
	}
</script>



</body>
</html>